# ‚úì –†–Ü–®–ï–ù–ù–Ø –ü–†–û–ë–õ–ï–ú–ò 403 Forbidden –ø—Ä–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—ñ —Å—Ç–∞—Ç—É—Å–∞–º–∏ —ñ–Ω–≤–æ–π—Å—ñ–≤

## –í–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞:

```bash
curl -X POST 'https://services.leadconnectorhq.com/invoices/690db165294c45e833a49810/send?altId=Yw5AVHYjRDNkmHxR2Wnn&altType=location' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28" \
  -H "Content-Type: application/json" \
  -d '{"action": "send_manually"}'

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# {"message":"Forbidden resource","error":"Forbidden","statusCode":403}
```

## üî¥ –û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏—á–∏–Ω–∏ –ø–æ–º–∏–ª–∫–∏ 403:

### 1Ô∏è‚É£ **–î–æ–∑–≤–æ–ª–∏ –Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –Ω–µ –≤–∫–ª—é—á–µ–Ω—ñ**

**–¶–µ –Ω–∞–π—á–∞—Å—Ç—ñ—à–∞ –ø—Ä–∏—á–∏–Ω–∞!**

#### üëâ –Ø–∫ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É **GoHighLevel** ‚Üí **Settings** ‚Üí **Integrations**
2. –ó–Ω–∞–π–¥—ñ—Ç—å **Private Integrations**
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à—É —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é (—Ç–∞ —â–æ —Å—Ç–≤–æ—Ä–µ–Ω–∞ –∑ –∫–ª—é—á–µ–º `pit-e52e36db-72c6-469d-b895-5cf55c25d5d4`)
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–∑–¥—ñ–ª **Scopes** –∞–±–æ **Permissions**
5. –í–∫–ª—é—á—ñ—Ç—å:
   - ‚òëÔ∏è **Invoices** (Read + Write)
   - ‚òëÔ∏è **Contacts** (Read + Write)

**–Ø–∫—â–æ –¥–æ–∑–≤–æ–ª—ñ–≤ –Ω–µ–º–∞:**
- –í–∏–¥–∞–ª—ñ—Ç—å —Ü—é —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é
- –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –∑ –ø–æ—Ç—Ä—ñ–±–Ω–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏
- –°–∫–æ–ø—ñ—é–π—Ç–µ –Ω–æ–≤–∏–π API –∫–ª—é—á

---

### 2Ô∏è‚É£ **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Ç—É**

#### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Ç–∞–∫ —è–∫ –≤–∏ —Ä–æ–±–∏—Ç–µ):
```bash
curl -X POST 'https://services.leadconnectorhq.com/invoices/690db165294c45e833a49810/send?altId=Yw5AVHYjRDNkmHxR2Wnn&altType=location'
```

#### ‚úì –ü–†–ê–í–ò–õ–¨–ù–û (–ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö):
```bash
curl -X POST 'https://services.leadconnectorhq.com/invoices/690db165294c45e833a49810/send' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28" \
  -H "Content-Type: application/json" \
  -H "altId: Yw5AVHYjRDNkmHxR2Wnn" \
  -H "altType: location" \
  -d '{
    "action": "email",
    "emailTo": "client@example.com",
    "subject": "Your Invoice"
  }'
```

**–ö–ª—é—á–æ–≤—ñ —Ä—ñ–∑–Ω–∏—Ü—ñ:**
- ‚úÖ `altId` —Ç–∞ `altType` —É **–∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö**, –Ω–µ –≤ URL
- ‚úÖ `action` –º–æ–∂–µ –±—É—Ç–∏: `"email"`, `"sms"`, `"sms_and_email"`, `"send_manually"`
- ‚úÖ –î–ª—è email –¥–æ–¥–∞–π—Ç–µ `emailTo`, `subject`, `message`

---

### 3Ô∏è‚É£ **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ —Ü–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –ª–æ–∫–∞—Ü—ñ—è**

```bash
# –û—Ç—Ä–∏–º–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –≤–∞—à–∏—Ö –ª–æ–∫–∞—Ü—ñ–π:
curl -X GET 'https://services.leadconnectorhq.com/locations/' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28"

# –ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å–∫–æ–ø—ñ—é–π—Ç–µ id –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –ª–æ–∫–∞—Ü—ñ—ó
# –ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ –∑ –≤–∞—à–∏–º altId: Yw5AVHYjRDNkmHxR2Wnn
```

---

## üü¢ –ü–æ—à–∞–≥–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å –≤–∏—Ä—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ API –∫–ª—é—á

```bash
curl -X GET 'https://services.leadconnectorhq.com/locations/' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28"

# –Ø–∫—â–æ 200 OK - –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
# –Ø–∫—â–æ 401 Unauthorized - –∫–ª—é—á –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
# –Ø–∫—â–æ 403 Forbidden - –¥–æ–∑–≤–æ–ª–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ñ
```

### –ö—Ä–æ–∫ 2: –û—Ç—Ä–∏–º–∞–π—Ç–µ ID –ø–µ—Ä—à–æ–≥–æ —ñ–Ω–≤–æ–π—Å–∞ –¥–ª—è —Ç–µ—Å—Ç—É

```bash
curl -X GET 'https://services.leadconnectorhq.com/invoices/?limit=1' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28" \
  -H "altId: Yw5AVHYjRDNkmHxR2Wnn" \
  -H "altType: location"

# –ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å–∫–æ–ø—ñ—é–π—Ç–µ id –ø–µ—Ä—à–æ–≥–æ —ñ–Ω–≤–æ–π—Å–∞
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥: 690db165294c45e833a49810
```

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å —Ü—å–æ–≥–æ —ñ–Ω–≤–æ–π—Å–∞

```bash
curl -X GET 'https://services.leadconnectorhq.com/invoices/690db165294c45e833a49810' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28" \
  -H "altId: Yw5AVHYjRDNkmHxR2Wnn" \
  -H "altType: location"

# –®—É–∫–∞–π—Ç–µ –ø–æ–ª–µ "status"
# –ü–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –æ–¥–Ω–µ –∑: draft, sent, paid, void, partially_paid
```

### –ö—Ä–æ–∫ 4: –°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å (–ü–†–ê–í–ò–õ–¨–ù–ò–ô –∑–∞–ø–∏—Ç)

```bash
# –Ø–∫—â–æ —Å—Ç–∞—Ç—É—Å = "draft", —Å–ø—Ä–æ–±—É–π—Ç–µ –π–æ–≥–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏:
curl -X POST 'https://services.leadconnectorhq.com/invoices/690db165294c45e833a49810/send' \
  -H "Authorization: Bearer pit-e52e36db-72c6-469d-b895-5cf55c25d5d4" \
  -H "Version: 2021-07-28" \
  -H "Content-Type: application/json" \
  -H "altId: Yw5AVHYjRDNkmHxR2Wnn" \
  -H "altType: location" \
  -d '{
    "action": "email",
    "emailTo": "test@example.com",
    "subject": "Your Invoice",
    "message": "Please review"
  }'

# –û—á—ñ–∫—É—î—Ç—å—Å—è 200 OK –∞–±–æ 201 Created
```

---

## üöÄ –ù–ê–ô–ü–†–û–°–¢–Ü–®–ò–ô –°–ü–û–°–Ü–ë: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ MCP —Å–µ—Ä–≤–µ—Ä

–ó–∞–º—ñ—Å—Ç—å –ø—Ä—è–º–∏—Ö curl –∫–æ–º–∞–Ω–¥, –∑–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–∞—à MCP —Å–µ—Ä–≤–µ—Ä —â–æ –≤–∂–µ –≤—Å–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–≤:

### 1Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
```bash
cd /path/to/project
npm install
```

### 2Ô∏è‚É£ –ù–∞–ª–∞—à—Ç—É–π—Ç–µ .env:
```bash
cp .env.example .env

# –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ .env —Ç–∞ –¥–æ–¥–∞–π—Ç–µ:
GHL_API_KEY=pit-e52e36db-72c6-469d-b895-5cf55c25d5d4
GHL_LOCATION_ID=Yw5AVHYjRDNkmHxR2Wnn
GHL_BASE_URL=https://services.leadconnectorhq.com
```

### 3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç:
```bash
bash scripts/test-invoice-api.sh
```

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –≤—Å–µ –∑–∞ –≤–∞—Å!

### 4Ô∏è‚É£ –ó–∞–ø—É—Å—Ç—ñ—Ç—å HTTP —Å–µ—Ä–≤–µ—Ä:
```bash
npm run dev:http
```

### 5Ô∏è‚É£ –¢–µ–ø–µ—Ä –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ endpoints:

```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å–∏
curl http://localhost:8000/api/invoices/status-info

# –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
curl http://localhost:8000/api/invoices/operations

# –ó–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—Å—Ç—ñ—à–µ:
curl -X POST http://localhost:8000/api/invoices/change-status \
  -H "Content-Type: application/json" \
  -d '{
    "invoiceId": "690db165294c45e833a49810",
    "targetStatus": "sent",
    "action": "email",
    "emailTo": "test@example.com"
  }'

# –¢–µ—Å—Ç—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é:
curl http://localhost:8000/api/config/test
```

---

## üìã –ß–∞—Å—Ç—ñ —Å—Ç–∞—Ç—É—Å–∏ –ø–æ–º–∏–ª–æ–∫ —Ç–∞ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è

| –ö–æ–¥ | –ü–æ–º–∏–ª–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†—ñ—à–µ–Ω–Ω—è |
|-----|---------|---------|---------|
| 401 | Unauthorized | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π API –∫–ª—é—á | –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–ª—é—á —É Settings |
| 403 | Forbidden | –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–∑–≤–æ–ª—ñ–≤ | –í–∫–ª—é—á—ñ—Ç—å –¥–æ–∑–≤–æ–ª–∏ "Invoices" |
| 404 | Not Found | –Ü–Ω–≤–æ–π—Å –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ | –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ ID —ñ–Ω–≤–æ–π—Å–∞ |
| 400 | Bad Request | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç | –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ |
| 422 | Unprocessable | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å—Ç–∞—Ç—É—Å –ø–µ—Ä–µ—Ö–æ–¥—É | –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Ü–µ–π —Å—Ç–∞—Ç—É—Å |

---

## üéØ –ü—Ä–∏–∫–ª–∞–¥–∏ –¥–ª—è n8n

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ —ñ–Ω–≤–æ–π—Å

```json
{
  "method": "POST",
  "url": "http://YOUR_MCP_SERVER:8000/api/invoices/change-status",
  "headers": {
    "Content-Type": "application/json"
  },
  "body": {
    "invoiceId": "{{ $json.invoiceId }}",
    "targetStatus": "sent",
    "action": "email",
    "emailTo": "{{ $json.customerEmail }}"
  }
}
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ó–∞–ø–∏—Å–∞—Ç–∏ –ø–ª–∞—Ç—ñ–∂

```json
{
  "method": "POST",
  "url": "http://YOUR_MCP_SERVER:8000/api/invoices/change-status",
  "headers": {
    "Content-Type": "application/json"
  },
  "body": {
    "invoiceId": "{{ $json.invoiceId }}",
    "targetStatus": "paid",
    "amount": {{ $json.paymentAmount }},
    "paymentDate": "{{ $json.paymentDate }}",
    "paymentMethod": "credit_card"
  }
}
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –ê–Ω—É–ª—é–≤–∞—Ç–∏ —ñ–Ω–≤–æ–π—Å

```json
{
  "method": "POST",
  "url": "http://YOUR_MCP_SERVER:8000/api/invoices/change-status",
  "headers": {
    "Content-Type": "application/json"
  },
  "body": {
    "invoiceId": "{{ $json.invoiceId }}",
    "targetStatus": "void",
    "reason": "{{ $json.voidReason }}"
  }
}
```

---

## ‚úÖ –ß–µ–∫-–ª—ñ—Å—Ç –≤–∏—Ä—ñ—à–µ–Ω–Ω—è

- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏–≤ —â–æ API –∫–ª—é—á –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `pit-`
- [ ] –ü–µ—Ä–µ–π—à–æ–≤ –≤ GoHighLevel Settings ‚Üí Private Integrations
- [ ] –í–∫–ª—é—á–∏–≤ –¥–æ–∑–≤–æ–ª–∏ "Invoices" –¥–ª—è –º–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó
- [ ] –°–ø—Ä–æ–±—É–≤–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ `altId` —Ç–∞ `altType` —É –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö, –Ω–µ –≤ URL
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏–≤ —â–æ lokacija ID –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
- [ ] –ó–∞–ø—É—Å—Ç–∏–≤ `test-invoice-api.sh` –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- [ ] –ó–∞–ø—É—Å—Ç–∏–≤ MCP —Å–µ—Ä–≤–µ—Ä —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –Ω–æ–≤—ñ endpoints

---

## üîó –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- üìñ [INVOICE_STATUS_MANAGEMENT.md](./INVOICE_STATUS_MANAGEMENT.md) - –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- üß™ [TROUBLESHOOTING_403_FORBIDDEN.md](./TROUBLESHOOTING_403_FORBIDDEN.md) - –î–µ—Ç–∞–ª—å–Ω–µ —Ä–æ–∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º
- üì± [N8N_INVOICE_INTEGRATION.md](./N8N_INVOICE_INTEGRATION.md) - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ n8n
- üöÄ [QUICK_START_INVOICE_STATUS.md](./QUICK_START_INVOICE_STATUS.md) - –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

---

**–Ø–∫—â–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤–∏—Ä—ñ—à–µ–Ω–∞ –ø—ñ—Å–ª—è –≤—Å—ñ—Ö –∫—Ä–æ–∫—ñ–≤:**

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å: `bash scripts/test-invoice-api.sh`
2. –ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤–∏–≤–æ–¥–æ–º —Å–∫—Ä–∏–ø—Ç—É
3. –ö–æ–Ω—Ç–∞–∫—Ç—É–π—Ç–µ GoHighLevel Support: support@gohighlevel.com
